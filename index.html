<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="What the package does (one paragraph).">
<title>What the Package Does (One Line, Title Case) • conditionR</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="What the Package Does (One Line, Title Case)">
<meta property="og:description" content="What the package does (one paragraph).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">conditionR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="conditionr">conditionR<a class="anchor" aria-label="anchor" href="#conditionr"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>Gracefully dealing with errors can be hard, particularly in shiny apps. There are many operations that your shiny application might take that could cause an issue that you want to recover from in some fashion. Applying changes to a database, we might want to rollback if something unexpected is found. If a user supplies data in a different format to that expected we might want to indicate that to them, rather than have the session crash. <em>Maybe you’re born with it</em> but I found dealing with different types of issues in shiny apps difficult, so wrote this package to facilitate easier processing of different types of issues. With {conditionR}, make your shiny application stand <em>head and shoulders</em> above the rest by adding infrastructure for condition and error handling to your reactives and observers.</p>
<p>Each shiny reactive and observer function can be called with specified condition handlers, restart procedures as well as default handlers that should apply to all reactive and observer functions. {conditionR} also provides a monkey patch for the shiny functions, so that you don’t have to manually update all calls to these functions. Just add</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">conditionR</span><span class="fu">::</span><span class="fu">monkey_patch_shiny</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>at the top of your app server to apply this infrastructure to the existing calls to <code>shiny::reactive</code> etc.</p>
<p><em>Because you’re worth it</em></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of conditionR like so:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.package("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"jamieRowen-mediacom/conditionR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example which shows you how to solve a common problem:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">conditionR</span><span class="op">)</span></span>
<span><span class="co">## basic example code</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.rstudio.com/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># a basic ui for triggering conditions</span></span>
<span><span class="va">ui</span> <span class="op">=</span> <span class="fu">fluidPage</span><span class="op">(</span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu">actionButton</span><span class="op">(</span><span class="st">"go"</span>, <span class="st">"GO Specific handler!"</span><span class="op">)</span>,</span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu">actionButton</span><span class="op">(</span><span class="st">"go2"</span>, <span class="st">"Go default handler!"</span><span class="op">)</span>,</span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu">actionButton</span><span class="op">(</span><span class="st">"go3"</span>, <span class="st">"Go default and specific handler!"</span><span class="op">)</span>,</span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu">textOutput</span><span class="op">(</span><span class="st">"out"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># a new condition signal type</span></span>
<span><span class="va">default_condition</span> <span class="op">=</span> <span class="fu"><a href="reference/condition_factory.html">condition_factory</a></span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># a function to raise a default condition signal</span></span>
<span><span class="va">throw_default</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">default_condition</span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># a handler function for default condition</span></span>
<span><span class="va">handle_default</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu">showModal</span><span class="op">(</span></span>
<span>    <span class="fu">shiny</span><span class="fu">::</span><span class="fu">modalDialog</span><span class="op">(</span><span class="st">"Default Condition handled"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># register this handler to apply to all reactives/observers</span></span>
<span><span class="va">handle_default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/as_handler.html">as_handler</a></span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/register_shiny_condition_handler.html">register_shiny_condition_handler</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># an error handling function</span></span>
<span><span class="va">handle_error</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu">showNotification</span><span class="op">(</span><span class="st">"There was an error"</span><span class="op">)</span></span>
<span>  <span class="fu">skip</span><span class="op">(</span><span class="op">)</span> <span class="co"># with skip if an error is hit, restart execution by returning NULL instead of crashing</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># register the error handler to apply by deafult</span></span>
<span><span class="va">handle_error</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/as_handler.html">as_handler</a></span><span class="op">(</span><span class="st">"error"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/register_shiny_condition_handler.html">register_shiny_condition_handler</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># a function to generate functions and sometimes return an "example condition" signal</span></span>
<span><span class="va">rand</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"should raise condition"</span><span class="op">)</span></span>
<span>    <span class="fu">example_condition</span><span class="op">(</span><span class="st">"bad value example"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># a function which induces an error</span></span>
<span><span class="va">bad</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"error"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">monkey_patch_shiny</span><span class="op">(</span><span class="op">)</span> <span class="co"># apply condition handling and restarts to shiny reactives and observers</span></span>
<span>  <span class="va">x</span> <span class="op">=</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu">reactiveVal</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">out</span> <span class="op">=</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu">renderText</span><span class="op">(</span><span class="fu">x</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># observeEvent will now take parameters for condition handlers</span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu">observeEvent</span><span class="op">(</span></span>
<span>    <span class="va">input</span><span class="op">$</span><span class="va">go</span>, <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"go"</span><span class="op">)</span></span>
<span>      <span class="va">val</span> <span class="op">=</span> <span class="fu">rand</span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="fu">x</span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span>      <span class="fu">throw_default</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="st">"conditionr_example"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="co"># handle the example condition signal</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"help!!!"</span><span class="op">)</span></span>
<span>      <span class="fu">shiny</span><span class="fu">::</span><span class="fu">showNotification</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">message</span>, session <span class="op">=</span> <span class="va">session</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    use_default_shiny_handlers <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># this observer should ignore the default handlers</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># this observer will respect the default handlers, clicking the button will throw a default condition</span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu">observeEvent</span><span class="op">(</span></span>
<span>    <span class="va">input</span><span class="op">$</span><span class="va">go2</span>, <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"go 2"</span><span class="op">)</span></span>
<span>      <span class="va">val</span> <span class="op">=</span> <span class="fu">rand</span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="fu">x</span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span>      <span class="fu">throw_default</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>   <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># an observer which respects both specific handlers and the registered defaults</span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu">observeEvent</span><span class="op">(</span></span>
<span>    <span class="va">input</span><span class="op">$</span><span class="va">go3</span>, <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"go"</span><span class="op">)</span></span>
<span>      <span class="va">val</span> <span class="op">=</span> <span class="fu">rand</span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="fu">x</span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span>      <span class="fu">throw_default</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="st">"conditionr_example"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"help!!!"</span><span class="op">)</span></span>
<span>      <span class="fu">shiny</span><span class="fu">::</span><span class="fu">showNotification</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">message</span>, session <span class="op">=</span> <span class="va">session</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># the functions have a wh_[*] equivalent</span></span>
<span>  <span class="co"># the monkey patch binds these definitions to the shiny functions</span></span>
<span>  <span class="co"># for convenience</span></span>
<span>  <span class="co"># this reactive will respect the default conditions (including the error handler)</span></span>
<span>  <span class="co"># as well as the specific</span></span>
<span>  <span class="va">r</span> <span class="op">=</span> <span class="fu">wh_reactive</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">shiny</span><span class="fu">::</span><span class="fu">invalidateLater</span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span>    <span class="va">x</span> <span class="op">=</span> <span class="fu">rand</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu">bad</span><span class="op">(</span><span class="op">)</span> <span class="co"># throw an error</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">x</span></span>
<span>  <span class="op">}</span>, <span class="st">"conditionr_example"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">shiny</span><span class="fu">::</span><span class="fu">showNotification</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"reactive condition handler "</span>, <span class="va">x</span><span class="op">$</span><span class="va">message</span><span class="op">)</span>, session <span class="op">=</span> <span class="va">session</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu">observe</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">=</span> <span class="fu">r</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">shiny</span><span class="fu">::</span><span class="fu">shinyApp</span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>`use_mit_license()`, `use_gpl3_license()` or friends to pick a
    license</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing conditionR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>First Last <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
